```markdown
# 出勤簿自動更新システム

## 📌 システム概要と目的

### 🎯 目的
このシステムは、従業員の **出退勤情報（出社時間、退社時間、在宅勤務、外部作業、欠席加算 など）** を、手作業から完全自動化するために開発されました。

✅ **「勤怠シート」に入力されたデータを自動解析し、各従業員のシートへ正確に転記**  
✅ **特定の識別子（例：「28」と記載された行）を検出し、勤怠情報を更新**  
✅ **転記ミスを防ぎ、作業時間を大幅短縮（約20分 → 40秒以内）**

### ⚠ 背景・課題
- **⏳ 手作業の負担**：毎日数十名分のデータを入力し、**約20分** を消費  
- **💥 ヒューマンエラー**：手入力による **転記ミス・計算ミス** が多発  
- **🔄 業務の属人化**：担当者依存のため、**引継ぎや休暇時に業務が滞るリスク**  

---

## 🔧 システムの詳細な機能と処理フロー

### 1️⃣ 勤怠データの自動更新 (`updateAttendanceData`)
📌 **処理の流れ**  
1. **「勤怠シート」のデータ取得**：A～F列（4行目以降）を取得  
2. **各行のデータ処理**：氏名・出社時間・退社時間・在宅・外部作業・欠席情報を処理  
3. **従業員シートの特定と更新**  
   - **A列に「28」がある行を探す**  
   - **該当行があればデータを更新（C列：出社、D列：退社、G～I列：出勤情報）**  

```javascript
if (targetRow !== -1) {
  sheet.getRange(targetRow, 3).setValue(startTime);
  sheet.getRange(targetRow, 4).setValue(endTime);
}
```

---

### 2️⃣ 勤務時間の計算 (`calculateWorkingHoursForAllSheets`)
📌 **処理の流れ**  
1. **各従業員シートの取得**（「勤怠シート」と連動）  
2. **出社・退社時間を分単位で解析**  
3. **午前・午後の判定を行い、昼休憩（1時間）を自動処理**  
4. **計算結果を E列 に出力（小数点以下2桁）**

```javascript
const workMinutes = endMinutes - startMinutes - (lunchBreak * 60);
const workHours = (workMinutes / 60).toFixed(2);
sheet.getRange(i, 5).setValue(workHours);
```

---

### 3️⃣ データ削除機能 (`deleteAttendanceDataByValue`)
📌 **処理の流れ**  
1. **全シートのA列を走査し、「28」のある行を特定**  
2. **該当するC～I列のデータを削除**  
3. **対象が見つからない場合はログ記録**

```javascript
if (targetRow !== -1) {
  sheet.getRange(targetRow, 3, 1, 7).clearContent();
}
```

---

## 🚀 技術的工夫とチャレンジ
- **📌 動的シート連携**：従業員のシートと「勤怠シート」の氏名を自動連携  
- **📌 文字列操作 & 条件分岐**：`replace()` を活用し、「在宅」などの不要データを除去  
- **📌 精密な時刻計算**：午前・午後・例外ケース（特定社員）を考慮したロジック  
- **📌 最新GAS & JavaScriptの活用**：`findIndex()` でデータ検索を高速化  

---

## 🏆 業務改善の成果
✅ **作業時間の短縮**：  
　手作業 **20分** → 自動処理 **40秒以内** 🎉  

✅ **正確性の向上**：  
　転記ミス・計算ミスを **ほぼゼロ** に  

✅ **業務プロセスの標準化**：  
　属人化を排除し、**誰でも均一な出勤簿作成が可能**  

---

## 🎯 ターゲットユーザー & 今後の展望
### 👥 **対象ユーザー**
- **総務・人事担当者**（中小企業、大企業問わず）
- **勤怠管理を効率化したい現場**
- **Googleスプレッドシートを活用する企業**

### 🔮 **今後の展望**
✅ エラー検出 & データ分析の強化  
✅ Webベースの管理画面を追加  
✅ AIによる勤怠異常検出を実装  

---

## 🔍 まとめ
「出勤簿自動更新システム」は **Google Apps Script (GAS)** を活用し、  
従来の **手作業による勤怠転記・時刻計算・不要データ削除** を **完全自動化** しました。

🎯 **作業時間削減** × **転記ミス削減** × **業務の効率化**  
✨ **シンプルで実用的なシステムとして、現場の負担を劇的に軽減！**  
```
